# Chapter 1  네트워크 시스템 개요

### 이 챕터에서 배우는 내용
- 컴퓨터 네트워크 조직 모델과 대역폭
- 레이턴시
- 네트워크 계층
- 데이터 캡슐화

---
### 네트워크 토폴로지
컴퓨터 네트워크는 두 개 이상의 장치 또는 노드간의 연결을 말하며 각 노드가 데이터를 공유할 수 있도록한다. 이러한 연결은 본질적으로 신뢰할 수 없거나 안전하지도 않다.

하지만 `go` 의 표준 라이브러리와 풍부한 생태계를 이용하면 안전하고 신뢰할 수 있는 네트워크 애플리케이션을 작성할 수 있다.

**핵심**💥

- 네트워크의 구조
- 네트워크가 프로토콜을 사용하여 통신하는 방법

### 네트워크 토폴로지 선택하기


네트워크 노드 구성을 `토폴로지` 라 한다.  네트워크의 토폴로지는 두 노드간의 단일 연결처럼 단순하거나 직접 연결을 공유하지는 않지만 데이터를 교환할 수 있는 노드의 레이아웃처럼 복잡할 수 있다.


<img src="../imgs/chapter1-1.png" width="450px" height="300px" title="px(픽셀) 크기 설정" alt="RubberDuck"></img><br/>

1. **점대점(point to point) 토폴로지**
    
    두 노드간의 직접 연결 
    

- 이런 연결의 경우는 드물지만 두 노드 간의 직접 통신이 필요할 때 유용하다.
- 이러한 *점대점* 연결을 *데이지 체인(Daisy Chain)*이라 한다.  예를들어 `A-B-C-D` 의 4개의 노드로 구성된 데이지 체인에서 노드 `D`로 도착 예정인 노드 `A` 의 트래픽은 반드시 `B-C` 를 통과해야한다.
- 목적지 사이의 중간 노드를 `홉` 이라 한다.
- 현대 네트워크에선 보기 힘든 유형

2. **버스(bus)형 토폴로지**

- 버스형 토폴로지상의 노드들은 **공통, 공유 네트워크 링크**를 가진다.
- 이 토폴로지는 유선 네트워크에서는 일반적으로 사용되지 않고 무선 네트워크에서 사용된다.
- 유선 네트워크상의 노드는 모든 트래픽을 보고 자신에게 필요한 트래픽만을 선택적으로 무시하거나 수신한다.
- 노드 `A` 가 노드 `F` 에게 트래픽을 보내면 동일 토폴로지상에 속한 다른 모든 노드 또한 트래픽을 수신하지만 무시하고 노드 `F`에게 해당 데이터를 수신한다.
- 무선 네트워크상의 노드들 또한 서로의 트래픽을 볼 수 있지만 일반적으로 `암호화` 되어있다.

3. **링(ring)형 토폴로지**
    
    트래픽이 단일 방향으로 이동하는 링으로 정렬된 노드
    
- 일부 광섬유 네트워크 배포에 사용된다.
- 데이터가 **단일 방향**으로 흐르는 폐쇄 루프이다.
- `A-B-C-D-E` 와 같이 링형 토폴로지가 구성되어 있는 경우 노드 `A`에서 노드 `E` 로 데이터를 송신할 때 중간의 노드를 모두 거쳐 노드 `E` 로 전달될 수 있다.  만약 중간 노드가 데이터를 전송하지 못하면 전송된 메시지는 목적지에 도달하지 않는다. 이러한 특성으로 **데이터의 속도는 가장 느린 노드의 속도로 제한된다.**
- 특정 노드의 전송 속도가 느릴때 이 노드가 데이터 전송 경로에 포함된 경우라면 데이터 전송 속도에 큰 영향을 받는다.

4. **스타(start)형 토폴로지**
    
    노드 간의 트래픽을 처리하는 중앙 노드에 연결된 노드
    
- 중앙 노드는 다른 모든 노드에 개별 점대점 연결을 한다.
- **유선 네트워크는 대부분 이 토폴로지 형태를 보인다.**
- 중앙 노드는 대개 **`네트워크 스위치`이며 이는 발신 노드로부터 데이터를 수신하여 목적지 노드로 데이터를 재전송하는 장치**이다.
- 장치를 스위치에 연결하는 것으로 쉽게 네트워크에 노드를 추가할 수 있다.
- 이 토폴로지에서 데이터는 하나의 `홉`만 이동한다.

5. **그물(mesh)형 토폴로지**
    
    그물형 네트워크에 상호 연결된 노드
    
- `Fully connected` 된 그물형 네트워크의 모든 노드는 다른 모드와 직접 연결된다.
- 이 토폴로지는 단일 노드의 장애가 네트워크에 있는 다른 노드 간의 트래픽에 영향을 주지 않기 때문에 `단일 장애 지점(Single Point of Failure, SPOF` 를 제거한다.
- 노드 수가 증가함에 따라 `비용` 과 `복잡성` 이 증가하여 대규모 네트워크에서는 이 토폴로지를 사용할 수 없다.
- **대규모 무선 네트워크**에서만 볼 수 있는 토폴로지이다.

6. 하이브리드 토폴로지
    
    둘 이상의 토폴로지가 결합된 케이스 (스타 / 링, 스타 - 버스)
    
- 현실 세계에서는 단일 토폴로지로 네트워크가 구성된 경우는 보기 힘들며 대부분 하이브리드 토폴로지이다.
- 하이브리드 토폴로지는 각 토폴로지의 장점을 활용하고 단점을 개별 네트워크 세그먼트로 제한하여 `안정성`  `확장성` `유연성` 을 향상하기 위해 사용한다.
- 어떤  노드에 장애가 발생했을 때 특정 노드 집합에 대해서만 장애를 진단할 수 있다.

---

### 대역폭



---

- **네트워크 대역폭은 일정 시간 내에 네트워크 연결을 통해 전송할 수 있는 데이터의 양**이다.
- 인터넷 연결 다운로드 속도가 100Mbps라면, 이론적으로 인터넷 연결이 서비스 공급자(KT, SK), **ISP** 에서 모뎀으로 초당 최대 100메가비트를 전송해야한다.
- 대역폭이 높아야 성능이 좋은걸까?
    - 먼저 대역폭이 높다고 성능이 좋다고 결론짓지 말아야한다.
    - 대역폭이 높아야 연결 속도도 빠르고 성능도 좋다고 생각하기 쉽다. 하지만 속도가 빠르다고 해서 반드시 성능이 향상되는 것은 아니다.
    - 대역폭이 낮더라도 레이턴시가 작은 경우가 대역폭이 높지만 큰 레이턴시를 갖는 네트워크보다 성능이 더 좋을 수 있다.
    - 레이턴시에 대한 고려가 필요하다.
    

### 레이턴시

---

- 네트워크 레이턴시는 네트워크 리소스 요청을 보내고 응답을 받는 사이에 측정된 시간이다.
- 레이턴시의 예로 웹사이트의 링크를 클릭한 뒤 결과 페이지가 화면상에 렌더링될 때까지 소요되는 지연시간이 있다.
    - 링크를 클릭했는데 웹 브라우저가 서버로부터 응답받지 못하고 멈춰버리는 현상이 있는데 이는 브라우저가 응답을 기다리는 최대 시간보다 레이턴시가 더 클 때 발생한다.
    - 이처럼 레이턴시가 크면 나쁜 사용자 경험을 제공하게 되며 큰 레이턴시를 이용하여 사용자들이 소프트웨어나 서비스를 이용하지 못하게 하는 `Ddos` 공격을 할 수 있다.
- 레이턴시의 유형
    - 레이턴시는 `클라이언트` - `서버` 간의 네트워크 레이턴시
    - 데이터 저장소에서 데이터를 검색하는 데 걸리는 시간
    - 서버 측에서 동적인 콘텐츠를 컴파일하는 데 걸리는 시간
    - 웹 브라우저가 페이지를 렌더링하는 데 걸리는 시간
- `API` 등의 네트워크 소프트웨어를 작성할 때 레이턴시를 최소화하는 것은 사용자 경험(`UX)` 에서 굉장히 중요하다.
    - 구글의 검색 성능
- 레이턴시의 원인을 해결하기 위한 방법
    - `콘텐츠 전송 네트워크(Content Delivery Network, CDN)나 클라우드를 사용하여 사용자와 서비스 사이의 거리와 `홉` 수를 모두 줄일 수 있다.
    - 요청 및 응답 크기를 최적화하여 레이턴시를 줄일 수 있다.
    - 캐싱 전략을 수립하여 성능을 크게 개선할 수 있다.
    - `GO` 의 `goroutine` 을 통해 제공하는 동시성, 병행성의 이점을 활용하여 서버 측 응답이 `블로킹` 되는 것을 최소화할 수 있다.

---

### OSI 참조 모델 - (Open Systems Interconnection)

- OSI 참조 모델은 프로토콜의 개발과 통신을 위한 프레임워크의 역할을 한다.
- `프로토콜` 은 네트워크를 통해 전송되는 데이터의 포맷과 순서를 결정하는 규칙 혹은 절차를 의미한다.
    - 전송 제어 프로토콜(`Transmission Control Protocol`)을 사용하는 통신에서는 메시지 수신자가 수신을 확인할 경우 확인 응답 메시지를 회신해야한다.
    - 그렇지 않으면 `TCP` 는 메시지를 재전송할수도 있다.
    - 요즘은 OSI 참조 모델은 예전만큼 사용되진 않지만, 하드웨어의 관점에서 로우 레벨의 네트워킹, `라우팅`과 같은 일반적인 개념을 이해할 수 있다는 점에서 중요하다.


### OSI 참조 모델의 계층 구조 레이어
---

OSI 참조 모델은 네트워크 내의 모든 활동을 7개의 계층으로 구성된 엄격한 게층 구조로 구분한다. 이렇게 계층을 나누는 것을 소프트웨어에서 `추상화` 라고 생각할 수 있다.

예를들어 네트워크 프로그램을 개발할 때 사용할 수 있는 `7계층` 의 라이브러리가 존재하는 것이 아니다. 작성한 프로그램이 7계층에서 서비스를 구현하는 것이다.

OSI 참조 모델의 7개 계층은 다음과 같다.

- 7계층 - **애플리케이션 계층**
    - 네트워크 애플리케이션과 라이브러리는 대부분 애플리케이션 계층과 상호 작용한다. 애플리케이션 게층은 호스트를 식별하고 리소스를 검색하는 역할을 담당한다.
    - 7계층 애플리케이션의 예시로는 웹 브라우저, 카카오톡등이 있다.

<br>

- 6계층 - **프레젠테이션 계층**
    - 데이터가 아래 계층으로 이동할 때 네트워크 계층에 대한 데이터를 준비한다.
    - 데이터가 윗 계층으로 이동할 때 애플리케이션 계층에 대한 데이터를 준비한다.
    - 6계층 기능의 예시로는 `암호화` , `암호 해독` `데이터 인코딩` 등이 있다.

<br>

- 5계층 - **세션 계층**
    - 네트워크의 노드 간의 연결 수명 주기를 관리한다.
    - 연결 수립, 연결 시간 초과 관리, 작동 모드 조정, 연결 종료 등의 기능을 담당한다.
    - 일부 7계층의 프로토콜은 5계층에서 제공하는 서비스에 의존한다.

<br>

- 4계층 - **전송 계층**
    - 전송의 안정성을 유지하면서 두 노드 간 데이터의 전송을 제어하고 조정한다.
    - 데이터 전송이 신뢰성을 유지하기 위해서는 에러 수정, 데이터 전송 속도 제어, 데이터 청킹(chunking) 및 분할, 누락된 데이터 재전송, 수신 데이터 확인 과정 등이 포함된다.
    - 수신자가 데이터 수신을 인정(`ACK`)하지 않는 경우 이 계층의 프로토콜이 데이터를 재전송하게 된다.

<br>

- 3계층 - **네트워크 계층**
    - 노드 간에 데이터를 전송하는 역할을 한다. 원격 노드에 직접 점대점으로 연결하지 않고도 네트워크 주소로 데이터를 전송할 수 있다.
    - OSI 참조 모델의 네트워크 계층에서는 전송의 신뢰성이나 전송 에러 등을 전송자에게 알려 주기 위한 별도의 프로토콜이 필요하지 않다.
    - 네트워크 계층은 라우팅, 주소 지정,  멀티캐스팅 및 트래픽 제어와 관련된 네트워크 관리를 위한 프로토콜의 중심이다.

<br>

- 2계층 - **데이터 링크 계층**
    - 직접 연결된 두 노드 간의 데이터 전송을 처리한다.
    - 데이터 링크 계층은 시스템에서 스위치로, 스위치에서 다른 시스템으로 데이터를 쉽게 전송할 수 있도록 지원한다.
    - 데이터 링크 계층에서의 프로토콜은 물리 계층의 에러를 식별하여 수정을 시도한다.
    - 데이터 링크 계층의 재전송 및 흐름 제어 기능은 하위의 물리적 매체에 따라 달라진다.
        - 예를들어 이더넷(유선)은 잘못된 데이터를 재전송하지 않는 반면, 무선은 재전송한다.
        - 이더넷 네트워크에서는 비트 에러가 거의 발생하지 않지만 무선 네트워크에서는 흔하게 비트 에러가 발생하기 때문이다.
        - 네트워크 프로토콜 스택의 상위 계층에 위치한 프로토콜은 일반적으로 데이터 링크 계층에 비해 효율성이 떨어지지만 데이터 전송의 안정성을 보장한다.

<br>

- 1계층 - **물리 계층**
    - 네트워크 스택에서 발생한 비트를 하위의 물리적 매체가 제어할 수 있는 전기, 광학 또는 무선 신호로 변환하고, 타 노드의 물리적 매체에서 받은 신호를 다시 비트로 변환한다.
    - 물리 계층에서는 `비트 전송률`을 제어한다. `비트 전송률` 은 데이터의 최대 제한 속도이다.
        - 초당 1기가비트(1Gbps)의 비트 전송률은 출발지에서 목적지 사이에 초당 최대 10억 비트의 데이터가 이동할 수 있음을 의미한다.
        - 네트워크의 전송 속도는 초당 비트 단위로 측정된다.
        - 100Mbps의 다운 속도는 100MB 파일은 1초만에 다운로드할 수 있다는 의미가 아니다. 초당 최대 12.5mb를 전송할 수 있다고 말하는 것이 정확하다.

---
### TCP/IP 모델
- 애플리케이션 계층
- 전송계층
- 인터넷 계층
- 링크 계층

